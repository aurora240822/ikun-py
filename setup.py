###############################################################################################################
#    ...............                        |      /                                                            #
#  ................... .                    |     | /    {      }   /\    /                                               #
# .........................                 |    |、    {      }   /  \  /                                             #
# ..........................                |   |   、  { ____}   /    \/                                                   #
# .............................                                                                               #
# ................................                                                                            #
# ..................................                                                                          #
# .....................................                                                                       #
# ........................................                      .   .,]O@@@@@\]. .  .                         #
# .........................................                       ./@@@@@@@@@@@@@@@].   .                     #
# .........................................   .   ,/@@@@@@@\]`. ./@@@O`........,\@@@@@@] .                    #
# ...........................................,]@@@@@@@@@@@@@@@@@@@@/... ...    ....,\@@@@@\.                  #
# .......................................]@@@@@@@/`.............,[`..  ................,@@@@@\`    .          #
# ...................................,/@@@@@/[.........  .    ..  ...  ..................][@@@@@`  .          #
# ................................,/@@@@@/`.....,/[]`^........../@\....,@@\..... ..........[]\@@@@\.          #
# ............................../@@@@O```...]/[`*,`...........,@@@@../@@@@@@@\..........  ....\/@@@@\. .      #
# ...........................,@@@@@\/` ..]oo*[...............,@@@/,@@@@@\`[@@@@O``.........  ....,O@@@\.   .  #
# ........................./@@@@/o. ..`\^o...................@@@O=@@@@@@@@@@@@@@@@`.... ...... ..../\@@@\.  . #
# ......................./@@@@[`. ..*/\[..... .]]..... .....=@@@@@@@@@@@@OOOO@@@@@@\^... @@@`..  ...*\O@@@`   #
# ...................../@@@/``. ..,[^^.....  ,o*`......]`...O@@@/[`**************\@@@O\..,@@@\... ....//@@@\  #
# .................../@@@@\` .............  .=/.......==/..,@@@^****.........*****\@@@^=...\@@@`.......*/@@@\ #
#  ................,@@@@`^. ......,@@`.... .[]*......./\*..=@@@****............****=@@@^\..=\@@@^... ...\/@@@\#
#     ............=@@@/*. ..... .,@@@^... .*,`........,o...=@@@@@@@@@\`..........***=@@@`....\@@@^... ...`,@@@#
#   .   ........./@@@[` ...... ..@@@^... .,*^....  ../]^...@@@^....[\@@@@`.......,/@@@@@/` ...,@@@^... ...^=@@#
#          .....@@@@\. ...*]` ..=@@@...  ,,\..... ...o\....@@@^..      \@@@`....@@@/`=@@@/` ...,@@@^......*/O@#
#             ./@@@*.=@@@*=o. ..O@@O*.. .^`^.... ...,o`....@@@*..        \@@\.,@@/  .,@@@@O]`..,/@@@^.......,@#
#             /@@@\..@@@`*^=. ..@@@^... .*\................@@@...         =@@@@@/   ..@@@@@@@@@@@@@@@^.......@#
#            .=@@@\`=@@@.=*^ ..=@@@^.. .==^.... ..../@@`...@@@*..  ,@@@@@^ \@@@@    ....../@@@@@@@@@@@...**..\#
#            . .\@@@@@@O.,^* ..=@@@*.. .*=^..=@@`...\@@@@@\@@@^.   @@@@@@@^=@@@^         =@@@@@@@.*@@@\..\/*./#
#                ..[=@@^.*,^...=@@@*.. .*=^.=@@@`..]@@@@@@@@@@O..  \@@@@@@ =@@@^         ,@@@@@@^.O@@@@\.==`=@#
#                   =@@^.*^*...=@@@/....*^`.=@@@@@@@@@@@...[[....    [[[`  @@@@@.          [\O[  @@@O@@@@O]@@@#
#                   =@@^.=^*...=@@@^^.......O@@@@@/`*\@@@` ......        ,@@@^@@@`             ,@@@`**,@@@@@@/#
#                   =@@^..\//@@@@@@^\.. ....O@@OO\**,..\@@@]           ,/@@@```\@@@`         ]@@@/.,]oOO@@@.  #
#                   ,@@@@@@@@@@O@@@O=`.....,/@@@OOO`.....[@@@@@]]]]]/@@@@@@@@@@@@@@@@@@@O@@@@@@`./OOOOOOO@@^  #
#                    ,@@@/\@@\]==@@@@@@@@@@@@@@@OOOO`.......,\@@@@@@@@@[...........,\@@@@/[[....OOOOOOOOO@@^  #
#                   ..]]]]/@@^..=OO@@@@@@@OOOOOOOOOO\............,@@/.................,@@@.....OOOOOOOOOO@@@  #
#         .   ,/@@@@@@@@@@@@@@...OOOOOOOOOOOOOOOOOOOO............@@@..................,@@@^...=OOOOOOOOOO@@O  #
#        .]@@@@@@O/\/^*oooo@@@^..\OOOOOOOOOOOOOOOOOO^............@@@@\............,]@@@@@@^...=OOOOOOOOO@@@^  #
#  .  ./@@@@O^o]/\oo/oo[\ooO@@@...OOOOOOOOOOOOOOOOOO.............=@@@@@@@@@@@@@@@@@@@/./@@.....OOOOOOOOO@@/   #
#   ./@@@@@@@@@@OOO]/oO]]OO@@@@@...\OOOOOOOOOOOOOO/...............,@@@],,[[[[[[[.....,@@/......=OOOOOOO@@@.   #
#  /@@@/o\`[[\@@@@@@@@@@@@@@@@@@@`...\OOOOOOOOOO/...................,\@@@@]].....]]@@@/`........=OOOO@@@@. .  #
# @@@\^\oo/[[\/\\]]]]/o/`/\ooOO@@@@`.....................................[\@@@@@@@/[..............\@@@@/...   #
# @@@@O\//\\,[\/\ooooooooooooo@@@@@@@\`.,]]O@@@@@@@@@@@@@@@@@@@@@@@@@@@O]]]...................,]/@@@@O........#
# @O@@@@@@@@@OO\/ooooooooooooO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@]]`.......=@@@@@@@@@@@@]...#
# oooooo/[[O@@@@@@@@\oo]o,oooO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^..#
# \\\ooo\[o/\o]o\[O@@@@@@@OOoO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...#
# oooooooooooooooooooooOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/....#
# /o=ooooooooooooooo\/\o//\/o@@@@@OO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/[[@^....#
# \oooo/[,/[\]ooooooooooooooO@^.............,\@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/`.......@^....#
# @@@@@@@@@O]]/\ooooooooooooo@@O\]]]]`.........,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/........,]]@^....#
# ,`\o[[\@@@@@@@@\/[^o\`\o^oooo@@@@@@@@@@\`......=@/[\@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/[[`=@/......]@@@@@@@.....#
# \/\\]/\/o[\//O@@@@@O/oooooooO@@@@@@@@@@@@@@`....\@O]]`....,[\@@@@@@@@@@@@/[[....,]]O@@@`....,@@@@@@@@@@@`...#
# \ooooooooooooo/ooO@@@@\/\ooO@@@@@@@@@@@@@@@@^...,@@@@@@@@@@O]]]........]]/@@@@@@@@@@@@^....@@@@@@@@@@@@@@`..#
# @o=ooooooooooo\[\/[/\@@@OooO@@@@@@@@@@@@@@@@@....@@@@@@@@@@@@@@@@@O.=@@@@@@@@@@@@@@@@@`...=@@@@@@@@@@@@@@@`.#
# ,@^o\/oooooooooooo/o\/\@@@@O@@@@@@@@@@@@@@@@@....@@@@@@@@@@@@@@@^......,@@@@@@@@@@@@@@....@@@@@@@@@@@@@@@@@.#
###############################################################################################################
#2024-ikun-setup.py#
from setuptools import setup, find_packages
import os
import platform
import sys,time
import subprocess
#print hello world
import tkinter as tk
from tkinter import  messagebox
import threading
system_os = platform.system()
#ikun_music_run()
from PIL import Image, ImageTk
import random
import sounddevice as sd
import soundfile as sf
messagebox.showwarning('提示','程序不是病毒，仅为恶搞，代码开源，地址待定')
time.sleep(1)
ikun_exit_now=messagebox.askyesno('提示','前方高能，请带好耳机，不要在公共场合食用,停止运行请多次ctrl+c，是否继续')
#是 退出 否 继续
if ikun_exit_now==False:
    sys.exit()
else:
    messagebox.showinfo('提示','调好音量，哎呀，你干嘛，发车了|emm,这只是setup')
# 定义初始工具类
class Ikun_Jntm_Playback:
    def __init__(self, file_path, start_time=5, end_time=7.3):
        # 读取音频文件
        self.data, self.fs = sf.read(file_path, dtype='float32')
        self.data_t,self.fs_t=sf.read('./assets/jntm.mp3', dtype='float32')
        self.start_sample = int(start_time * self.fs)  # 起始播放时间点
        self.end_sample = int(end_time * self.fs)      # 结束播放时间点

    def play_audio_segment(self):
        # 播放音频片段
        sd.play(self.data[self.start_sample:self.end_sample], self.fs)
        sd.sleep(1000)  # 播放后暂停1秒
    def play_audio_segment_niganma(self):
        # 播放音频片段
        sd.play(self.data_t[self.start_sample:self.end_sample], self.fs_t)
        sd.sleep(1000)  # 播放后暂停1秒
    def ikun_music_really_run(self, ikun_music_play_mode="common"):
        n = 100
        playback_thread_niganma = threading.Thread(target=self.play_audio_segment_niganma)
        playback_thread_niganma.start()
        if ikun_music_play_mode == "common":

            while n > 0:
                n -= 1
                time.sleep(0.3)
                while True:
                    playback_thread_one = threading.Thread(target=self.play_audio_segment)
                    playback_thread_two = threading.Thread(target=self.play_audio_segment)
                    playback_thread_one.start()
                    time.sleep(0.7)
                    playback_thread_two.start()
        else:
            while n > 0:
                n -= 1
                time.sleep(0.3)
                playback_thread_one = threading.Thread(target=self.play_audio_segment)
                playback_thread_two = threading.Thread(target=self.play_audio_segment)
                playback_thread_one.start()
                time.sleep(0.7)
                playback_thread_two.start()

    def stop(self):
        sd.stop()


    
class Tool:
    def __init__(self, root):
        self.root = root
        self.system_os = platform.system()
        self.setup_dict = {
            'name': 'ikun',
            'version': '0.0.25',
            'pip_Available': self.pip_available(),
            'start_install_time': time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time())),
            'system_os': self.system_os,
            'img_box': self.show_random_popup(),
            
            
        }


        # 加载并显示图片
        self.image_path = "./assets/ikun_mini.png"  # 替换为你的图片路径
        self.image = Image.open(self.image_path)
        self.photo = ImageTk.PhotoImage(self.image)
        
        # 创建图片标签
        self.label = tk.Label(self.root, image=self.photo)
        self.label.pack(expand=True, fill=tk.BOTH)
        self.ikun_text_list=['干嘛', '你', '哎呀', '鸡鸡你尼太美', '作者leebro', '及你太美', '模块正在安装', '小黑子', 'ikun', '来到', '欢迎', '你好']

        # 创建按钮并放置在主窗口中

        
        self.popup_count = 25
        threading.Thread(target=self.show_popups).start()  # 启动弹窗线程，self.show_popups()
        threading.Thread(target=self.play_music).start()

        # 初始化设置字典

    
    def play_music(self):
            # 播放音乐的逻辑
            try:
                
                player = Ikun_Jntm_Playback('./assets/jntm.mp3')
                try:
                    player.ikun_music_really_run('common')
                except KeyboardInterrupt:
                    print("\n播放已停止")
                    player.stop()
                
                # 实际的播放音乐代码
                print("播放音乐")
            except ImportError:
                print("无法导入音乐播放模块")
    def pip_available(self):
        # 检查 pip 可用
        try:
            subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'pip'])
            subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'soundfile'])
            subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'pillow'])
            subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'sounddevice'])
            return True
        except (subprocess.CalledProcessError, FileNotFoundError): #可能版本不兼容
            return False
    def show_popups(self):
        # 递归调用，每次弹出一个新的弹窗
        self._show_popup_count = 0

        def schedule_popup():
            if self._show_popup_count < self.popup_count:
                delay = random.randint(250, 1000)  # 随机延迟时间（1到3秒）
                self.root.after(delay, self.show_popup)
                self._show_popup_count += 1
                # 安排下一次弹窗
                self.root.after(delay + 25, schedule_popup)  # 延迟+1秒再安排下一个弹窗
            elif self._show_popup_count == self.popup_count:
                self.root.quit()
            
        
        schedule_popup()
    
    def show_popup(self):
        #print("show_popup 方法被调用") debug
        popup_window = tk.Toplevel(self.root)
        popup_window.title("弹窗")
        popup_window.geometry("200x100")
        ikun_text_countdown_number=max(0, int((self.popup_count - self._show_popup_count -2 ) / 2)) #kun啊，我也不知为什么除以2，但是这样不会出现报错，刚才用脑子想了很久，乱写的除以2就得到了期盼值        print(ikun_text_countdown_number)
        label = tk.Label(popup_window, text=self.ikun_text_list[ikun_text_countdown_number]) #期望数值每次弹窗-1
        label.pack(pady=20)
        
        # 1 秒后关闭弹窗
        popup_window.after(1000, popup_window.destroy)





    def show_random_popup(self):
        #print("show_random_popup 方法被调用")
        # 随机选择弹窗显示的时间（例如 1 到 3 秒之间）
        delay = random.randint(250, 1000)  # 时间单位是毫秒
        
        # 弹窗函数
        def popup():
            popup_window = tk.Toplevel(self.root)
            popup_window.title("弹窗")
            popup_window.geometry("200x100")
            label = tk.Label(popup_window, text='请欣赏‘鸡鸡你尼太美’')
            label.pack(pady=20)
            
            # 1 秒后关闭弹窗
            popup_window.after(1000, popup_window.destroy)
        
        # 延迟时间后显示弹窗
        self.root.after(delay, popup)

    def os_check(self):
        if self.system_os == 'Linux':
            print("\033[1;33m欢迎\033[0m使用，\033[1;31mkun你太美\033[0m")
            time.sleep(1)
            os.system('clear')
        elif self.system_os == 'Windows':
            try:
                import progress
            except ImportError:
                time.sleep(2)
                messagebox.showwarning("警告", "稍后重试，正在补充依赖")

                # os.system('cls') # 你可以取消注释以清除屏幕
        else:
            print(f"不支持该 {self.system_os} 系统")
            time.sleep(10)
            sys.exit()

# 创建主窗口
root = tk.Tk()
root.title("l🏀🏀.5")
root.geometry("600x400")  # 可以根据需要调整窗口大小

# 创建 Tool 实例
tool = Tool(root)

# 使用示例（调用 os_check 方法）
tool.os_check()


# 运行主循环
root.mainloop()

__Author__ = "leebro"
__project_start_time__ = "2024"
HERE = os.path.abspath(os.path.dirname(__file__))
#download_url='cxk.lwb.lol'

setup(
    name="love_ikun",  # sycc
    py_modules=["cxk1","cxk2"],
    version="0.0.25",
    description="虹源三式(一个有技术含量的四圆计算器)",  # 原
    #long_description=R,
    classifiers=[
        "Natural Language :: Chinese (Simplified)",
        "Development Status :: 6 - Mature",
        "Operating System :: Microsoft :: Windows",
        "Operating System :: POSIX :: Linux",
        "Operating System :: Android",
        "Topic :: Scientific/Engineering :: Mathematics",
        "Topic :: Terminals",
        "Topic :: System :: Shells",
        "Programming Language :: Python :: 3",
        "Programming Language :: Python :: 3 :: Only",
        "Programming Language :: Python :: 3.7",
        "Programming Language :: Python :: 3.8",
        "Programming Language :: Python :: 3.9",
        "Programming Langugge :: Python :: 3.10"
        "Programming Langugge :: Python :: 3.11"
        "Programming Langugge :: Python :: 3.12"
        "Intended Audience :: Developers",
    ],
    keywords=[
        "ikun",
        "edu",
    ],  # 关键字
    author=__Author__,
    author_email="ikun@lwb.lol",
    url="https://github.com",
    license="ikun license",
    packages=[...],
    python_requires=">=3.6",
    install_requires=["netifaces>=0.11.0", "sycc>=0.7.0","pip"],
    entry_points={
        "console_scripts": [
            "ikun-run = ",
            "get-pip = pip_check.get_pip:main",
        ]
    },
    package_dir = {
                   ''
                   
                   
                   
                   
                   },
    project_urls={
        "github": "https://github.com/py-lwb/sycc",
        "home": "https://github.com"
    },
    include_package_data=True,
    zip_safe=True,
)


